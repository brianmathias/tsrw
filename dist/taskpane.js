!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=307)}({307:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=["January","February","March","April","May","June","July","August","September","October","November","December"],a={sheets:{repertoire:"Repertoire",recitalPlanning:"Recital Planning",recitalHistory:"Recital History",workflowLog:"Workflow Log",workflowOptions:"Workflow Options"},fields:{performer:"OpPerformer",updateDates:"OpUpdateDates",addToHistory:"OpAddToHistory",dateColumn:"OpDateColumn",recitalCount:"OpRecitalCount",repField:"OpRepFieldName",dateField:"OpDateFieldName",v12Field:"OpV12FieldName",v2Field:"OpV2FieldName"},ranges:{}},s=function(e){this.number=e[0],this.letter=e[1],this.id=e[2],this.title=e[3],this.composer=e[4],this.length=e[5],this.tab=e[6],this.cc=e[7]},l=function(){function e(e,t,r,n,o){var i=this;this.dateStamp=e,this.date=this.dateStampToDate(this.dateStamp),this.dateString=this.dateStamptoString(this.dateStamp),this.performer=t,this.venue12=r,this.venue2=n,this.repertoire=[],o.forEach((function(e){if(""!=e[3]){var t=new s(e);i.repertoire.push(t)}})),this.repertoire.forEach((function(e,t,r){t===r.length-1&&"a."===e.letter?e.letter="":t<r.length-1&&"a."===e.letter&&"a."===r[t+1].letter&&(e.letter="")})),this.program=this.programToString()}return e.prototype.dateStampToDate=function(e){return new Date(86400*(e-25569)*1e3)},e.prototype.dateStamptoString=function(e){return this.dateStampToDate(e).toISOString().split("T")[0]},e.prototype.programToString=function(){var e=o[this.date.getUTCDay()]+", "+i[this.date.getUTCMonth()]+" "+this.date.getUTCDate()+", "+this.date.getUTCFullYear(),t="";t+=this.performer+"\n",t+=e+"\n",""!==this.venue12&&"None"!==this.venue12&&(t+="12:00 - "+this.venue12+"\n"),""!==this.venue2&&"None"!==this.venue2&&(t+="2:00 - "+this.venue2+"\n"),t+="\n";for(var r=0,n=this.repertoire;r<n.length;r++){var a=n[r],s="";""!==a.number?s+=a.number+" ":s+="   ",""!==a.letter&&(s+=a.letter+" "),t+=s+=a.title+" - "+a.composer+"\n"}return t},e}();function u(){return r(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,g(1)];case 1:return e.sent(),[2]}}))}))}function c(){return r(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,g(2)];case 1:return e.sent(),[2]}}))}))}function d(){return r(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,g(3)];case 1:return e.sent(),[2]}}))}))}function f(){return r(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,g(4)];case 1:return e.sent(),[2]}}))}))}function h(){return r(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,g(-1)];case 1:return e.sent(),[2]}}))}))}function g(e){return r(this,void 0,void 0,(function(){var t=this;return n(this,(function(o){switch(o.label){case 0:return[4,Excel.run((function(o){return r(t,void 0,void 0,(function(){var t,r,i,a,s,l;return n(this,(function(n){for(t=o.workbook.worksheets.getItem("Repertoire"),r=t.tables.getItem("RepertoireList"),i=0,a=["O1","O2","O3","O4"];i<a.length;i++)s=a[i],r.columns.getItem(s).filter.clear();return e>0&&e<5&&(l="O"+e.toString(),r.columns.getItem(l).filter.apply({filterOn:Excel.FilterOn.values,values:["1"]})),[2,o.sync()]}))}))}))];case 1:return o.sent(),[2]}}))}))}function p(){return r(this,void 0,void 0,(function(){var e=this;return n(this,(function(t){switch(t.label){case 0:return[4,Excel.run((function(t){return r(e,void 0,void 0,(function(){function e(e){var t=document.createElement("p");t.innerText=e,document.getElementById("log").appendChild(t)}function o(){return r(this,void 0,void 0,(function(){var r,o,i;return n(this,(function(n){switch(n.label){case 0:for(r=1;r<a.recitalCount+1;r++)(o={}).rep=a.repField.replace("{{index}}",r),o.date=a.dateField.replace("{{index}}",r),o.v12=a.v12Field.replace("{{index}}",r),o.v2=a.v2Field.replace("{{index}}",r),(i={}).rep=f.recitalPlanning.getRange(o.rep),i.date=f.recitalPlanning.getRange(o.date),i.v12=f.recitalPlanning.getRange(o.v12),i.v2=f.recitalPlanning.getRange(o.v2),i.rep.load("values"),i.date.load("values"),i.v12.load("values"),i.v2.load("values"),c.push(i);return[4,t.sync()];case 1:return n.sent(),c.forEach((function(e,t,r){if(""!==e.date.values[0][0]){var n=new l(e.date.values[0][0],a.performer,e.v12.values[0][0],e.v2.values[0][0],e.rep.values);d.push(n)}})),e(d.length+" recitals found."),[2]}}))}))}function i(o){return r(this,void 0,void 0,(function(){var r,i,s,l,u,c,d,h,g,p,m,v,y,b,w;return n(this,(function(n){switch(n.label){case 0:return(r=f.repertoire.getRange("RepertoireList")).load("values, rowIndex"),[4,t.sync()];case 1:n.sent(),i=r.rowIndex,s=a.dateColumn,d=0,h=o,n.label=2;case 2:return d<h.length?(g=h[d],r.load("values, rowIndex"),[4,t.sync()]):[3,6];case 3:for(n.sent(),p=0,m=g.repertoire;p<m.length;p++){for(v=m[p],y=0;y<r.values.length;y++)if(r.values[y][0]===v.id){c=r.values[y],l=y;break}u=i+l,(b=[]).push(g.dateStamp),b.push(c[s]),b.push(c[s+1]),b.push(c[s+2]),(w=[]).push(b),f.repertoire.getRangeByIndexes(u,s,1,4).values=w}return[4,t.sync()];case 4:n.sent(),n.label=5;case 5:return d++,[3,2];case 6:return e("Performance dates updated."),[2]}}))}))}function s(){return r(this,void 0,void 0,(function(){var r,o,i,a,s,l,u,c,f,h,g,p,m,v,y,b,w,k,x,I,O,T;return n(this,(function(n){switch(n.label){case 0:r=0,o=d,n.label=1;case 1:if(!(r<o.length))return[3,5];for(i=o[r],a=[],s=[],l=i.date.getUTCMonth()+1+"/"+i.date.getUTCDate()+"/"+i.date.getUTCFullYear(),a.push([l,"","","","",""]),s.push(["m/d/yyyy","","","","",""]),a.push(["12:00",i.venue12,"","","",""]),s.push(["@","@","","","",""]),a.push(["2:00",i.venue2,"","","",""]),s.push(["@","@","","","",""]),a.push(["ON","OL","ID","Title","Composer","Length"]),s.push(["Text","Text","Text","Text","Text","Text"]),u=0,c=i.repertoire;u<c.length;u++)f=c[u],a.push([f.number,f.letter,f.id,f.title,f.composer,f.length]),s.push(["@","","","","","0.00"]);return a.push(["","","","","",""]),s.push(["","","","","",""]),h=t.workbook.worksheets.getItem("Recital History"),(g=h.getUsedRange().getLastRow()).load("address,rowIndex"),[4,t.sync()];case 2:for(n.sent(),(p=h.getRangeByIndexes(g.rowIndex+4,0,a.length,6)).numberFormat=s,p.values=a,g.rowIndex+4,m=g.rowIndex+5,v=g.rowIndex+6,y=g.rowIndex+8,b=y+i.repertoire.length,(w=p.getRow(0)).merge(),w.format.horizontalAlignment="Right",w.format.font.bold=!0,w.format.font.size=14,w.format.borders.getItem("EdgeBottom").color="000000",h.getRangeByIndexes(m,0,1,1).format.font.bold=!0,h.getRangeByIndexes(m,1,1,5).merge(),h.getRangeByIndexes(v,0,1,1).format.font.bold=!0,h.getRangeByIndexes(v,1,1,5).merge(),(k=p.getRow(3)).format.fill.color="000000",k.format.font.color="FFFFFF",k.format.font.bold=!0,k.format.horizontalAlignment="Center",x=y;x<b;x++)I=h.getRangeByIndexes(x,0,1,6),x%2==0&&(I.format.fill.color="DADADA"),I.format.borders.getItem("EdgeTop").color="000000",I.format.borders.getItem("EdgeBottom").color="000000",I.format.borders.getItem("EdgeLeft").color="000000",I.format.borders.getItem("EdgeRight").color="000000";return h.getRangeByIndexes(y,4,i.repertoire.length,2).format.horizontalAlignment="Right",O=h.getRangeByIndexes(b,5,1,1),T="=SUM(F"+(y+1)+":F"+b+")",O.formulas=[[T]],O.format.font.bold=!0,O.format.horizontalAlignment="Right",O.numberFormat=[["0.00"]],[4,t.sync()];case 3:n.sent(),n.label=4;case 4:return r++,[3,1];case 5:return e(d.length+" recitals added to recital history."),[2]}}))}))}function u(){return r(this,void 0,void 0,(function(){var r,o,i,a,s,l;return n(this,(function(n){for(r={},o=new Date,i=o.getFullYear()+"-",o.getMonth()+1<10&&(i+="0"),i+=o.getMonth()+1+"-",o.getDate()<10&&(i+="0"),i+=o.getDate(),a="",s=0;s<d.length;s++)a+=d[s].date.getUTCMonth()+1+"/"+d[s].date.getUTCDate(),s<d.length-1&&(a+=", ");return r.date=i,r.recitals=d,l=JSON.stringify(r),f.workflowLog.tables.getItem("WorkflowLog").rows.add(0,[[i,a,l,""]]),e("JSON added to workflow log."),[2,t.sync()]}))}))}var c,d,f;return n(this,(function(r){switch(r.label){case 0:return document.getElementById("log").innerText="",e("Starting workflow..."),c=[],d=[],f={repertoire:t.workbook.worksheets.getItem(a.sheets.repertoire),recitalPlanning:t.workbook.worksheets.getItem(a.sheets.recitalPlanning),recitalHistory:t.workbook.worksheets.getItem(a.sheets.recitalHistory),workflowLog:t.workbook.worksheets.getItem(a.sheets.workflowLog),workflowOptions:t.workbook.worksheets.getItem(a.sheets.workflowOptions)},Object.keys(a.fields).forEach((function(e,t,r){a.ranges[e]=f.workflowOptions.getRange(a.fields[e]),a.ranges[e].load("values")})),[4,t.sync()];case 1:return r.sent(),Object.keys(a.ranges).forEach((function(e,t,r){a[e]=a.ranges[e].values[0][0]})),[4,o()];case 2:return r.sent(),"Y"!==a.updateDates?[3,4]:[4,i(d)];case 3:r.sent(),r.label=4;case 4:return"Y"!==a.addToHistory?[3,6]:[4,s()];case 5:r.sent(),r.label=6;case 6:return[4,u()];case 7:return r.sent(),e("Workflow complete."),[2]}}))}))}))];case 1:return t.sent(),[2]}}))}))}Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("run").onclick=p,document.getElementById("filter1").onclick=u,document.getElementById("filter2").onclick=c,document.getElementById("filter3").onclick=d,document.getElementById("filter4").onclick=f,document.getElementById("filterClear").onclick=h)}))}});
//# sourceMappingURL=taskpane.js.map